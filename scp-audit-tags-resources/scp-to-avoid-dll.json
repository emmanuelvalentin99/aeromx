{
  "Version": "2012-10-17",
  "Statement": [
    {
      "Sid": "DenyEC2WithoutTagEnvironment",
      "Effect": "Deny",
      "Action": ["ec2:RunInstances", "ec2:CreateSnapshot"],
      "Resource": [
        "arn:aws:ec2:*:*:instance/*",
        "arn:aws:ec2:*:*:snapshot/*"
      ],
      "Condition": { "Null": { "aws:RequestTag/Environment": "true" } }
    },
    {
      "Sid": "DenyEC2WithoutTagArea",
      "Effect": "Deny",
      "Action": ["ec2:RunInstances", "ec2:CreateSnapshot"],
      "Resource": [
        "arn:aws:ec2:*:*:instance/*",
        "arn:aws:ec2:*:*:snapshot/*"
      ],
      "Condition": { "Null": { "aws:RequestTag/lcf": "true" } }
    },
    {
      "Sid": "DenyEC2WithoutTagVertical",
      "Effect": "Deny",
      "Action": ["ec2:RunInstances", "ec2:CreateSnapshot"],
      "Resource": [
        "arn:aws:ec2:*:*:instance/*",
        "arn:aws:ec2:*:*:snapshot/*"
      ],
      "Condition": { "StringNotEqualsIfExists": {
          "aws:RequestTag/Environment": ["dev", "qa", "prod"] } }
    },
    {
      "Sid": "DenyEC2WithoutTagProjectName",
      "Effect": "Deny",
      "Action": ["ec2:RunInstances", "ec2:CreateSnapshot"],
      "Resource": [
        "arn:aws:ec2:*:*:instance/*",
        "arn:aws:ec2:*:*:snapshot/*"
      ],
      "Condition": { "StringNotEqualsIfExists": {
          "aws:RequestTag/lcf": ["IF", "DP", "NA"] } }
    }
  ]
}
